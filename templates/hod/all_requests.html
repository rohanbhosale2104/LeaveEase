{% extends "base.html" %}
{% block sidebar %}{% include "hod/sidebar.html" %}{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h5>All Leave Requests</h5>
  <span class="text-muted small">{{ hod.name }}</span>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    {% if requests %}
    <table class="table table-sm align-middle">
      <thead>
      <tr>
        <th>Student</th>
        <th>Batch</th>
        <th>Reason</th>
        <th>Dates</th>
        <th>Attendance</th>
        <th>Status</th>
      </tr>
      </thead>
      <tbody>
      {% for r in requests %}
      <tr>
        <td>{{ r.student.name }}</td>
        <td>{{ r.batch }}</td>
        <td>{{ r.reason }}</td>
        <td>{{ r.from_date }} - {{ r.to_date }}</td>
        <td>{{ r.attendance }}%</td>
        <td>
          {% set status = r.overall_status() %}
          {% if status == "Approved" %}
            <span class="badge bg-success">{{ status }}</span>
          {% elif status == "Rejected" %}
            <span class="badge bg-danger">{{ status }}</span>
          {% else %}
            <span class="badge bg-warning text-dark">{{ status }}</span>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
      </tbody>
    </table>
    {% else %}
    <p class="text-muted mb-0">No leave requests yet.</p>
    {% endif %}
  </div>
</div>
{% endblock %}
